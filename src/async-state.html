<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Component Example</title>
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="lib/main.ts" defer></script>
  </head>
  <body>
    <main
      class="flex flex-col justify-center min-h-screen max-w-xl px-2 mx-auto"
    >
      <h2>States</h2>
      <x-context value="{name: 'John'}">
        <section>
          <h3>Normal</h3>
          <div>
            <p>My name is <x-text value="{name}"></x-text></p>
            <x-if value="{name == 'John'}">
              <p><x-text value="{name}"></x-text> is here</p>
            </x-if>
          </div>
        </section>
      </x-context>
      <x-context>
        <section>
          <h3>No state</h3>
          <div>
            <p>My name is <x-text value="{name}"></x-text></p>
          </div>
        </section>
      </x-context>
      <x-context id="async-state-value">
        <section>
          <h3>Async Value State</h3>
          <div>
            <p>My name is <x-text value="{name}"></x-text></p>
          </div>
        </section>
      </x-context>
      <script>
        const asyncStateValue = document.getElementById('async-state-value');
        setTimeout(() => {
          asyncStateValue.setAttribute('value', '{name: "Jose"}');
        }, 1000);
      </script>
      <x-context id="async-state-set-state">
        <section>
          <h3>Async State</h3>
          <div>
            <p>My name is <x-text value="{name}">xxx</x-text></p>
            <x-if value="{name == 'Jane'}">
              <p><x-text value="{name}"></x-text> is here</p>
            </x-if>
          </div>
        </section>
      </x-context>
      <script>
        const asyncStateSetState = document.getElementById(
          'async-state-set-state'
        );
        setTimeout(() => {
          asyncStateSetState.setContext({ name: 'Jane' });
        }, 2000);
      </script>
      <x-context id="async-state-set-state-api">
        <section>
          <h3>State API</h3>
          <div>
            <p>My name is <x-text value="{name}"></x-text></p>
          </div>
        </section>
      </x-context>
      <script type="module">
        useContext('async-state-set-state-api', async () => {
          const name = reactive('Jane');

          effect(() => {
            console.log(name.value);
          }, [name]);

          setTimeout(() => {
            name.value = 'John';
          }, 1000);

          return { name };
        });
      </script>
      <x-context id="async-state-set-state-api-array">
        <section>
          <h3>State API Array</h3>
          <div>
            <x-for value="{names}">
              <p>My name is <x-text value="{$item}"></x-text></p>
            </x-for>
          </div>
        </section>
      </x-context>
      <script type="module">
        useContext('async-state-set-state-api-array', () => {
          const names = ['Jane', 'John', 'Doe'];

          return { names };
        });
      </script>
    </main>
  </body>
</html>

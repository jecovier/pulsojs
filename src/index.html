<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Component Example</title>
    <link rel="stylesheet" href="styles.css" />
    <script type="module" src="lib/main.ts" defer></script>
  </head>
  <body>
    <main
      class="flex flex-col justify-center min-h-screen max-w-xl px-2 mx-auto"
    >
      <x-state
        value="{name: 'John', fruits: ['apple', 'banana', 'cherry'], activities: {walking: {likes: 1, dislikes: 0}}}"
      >
        <h2>Basics</h2>
        <section>
          <h3>x-var</h3>
          <div>
            <p>My name is <x-var name></x-var></p>
          </div>
        </section>
        <section>
          <h3>x-elm</h3>
          <div>
            <x-elm>
              <button class="btn" onclick="{alert($state.name.value)}">
                what is my name?
              </button>
            </x-elm>
          </div>
        </section>
        <section>
          <h3>x-for</h3>
          <div>
            <p>Using $item state</p>
            <ul id="for-items-test">
              <x-for each="{$state.fruits}">
                <li class="text-green-500"><x-var $item></x-var></li>
              </x-for>
            </ul>
            <p>Using "as" attribute</p>
            <ul id="for-as-test">
              <x-for each="{$state.fruits}" as="element">
                <li class="text-red-500"><x-var element></x-var></li>
              </x-for>
            </ul>
          </div>
        </section>
        <section>
          <h3>Accessing object states</h3>
          <div>
            <p>
              First fruit: <x-var fruits[0]></x-var>
              <br />
              Walking likes: <x-var activities.walking.likes></x-var>
            </p>
          </div>
        </section>
      </x-state>
      <x-state value="{counter: 0}">
        <h2>Reactivity</h2>
        <section>
          <h3>Events</h3>
          <div>
            <div class="flex gap-2">
              <x-elm>
                <button
                  id="btn-plus"
                  class="btn w-10"
                  onclick="{$state.counter++}"
                >
                  +
                </button>
              </x-elm>
              <x-elm>
                <button
                  id="btn-minus"
                  class="btn w-10"
                  onclick="{$state.counter--}"
                >
                  -
                </button>
              </x-elm>
              <x-elm>
                <button
                  id="btn-reset"
                  class="btn"
                  onclick="{$state.counter = 0}"
                >
                  reset
                </button>
              </x-elm>
            </div>
          </div>
        </section>
        <section>
          <h3>value</h3>
          <div>
            <p id="counterResult" class="!text-xl">
              Counter: <x-var counter></x-var>
            </p>
          </div>
        </section>
        <section>
          <h3>attributes</h3>
          <div>
            <x-elm>
              <p class="{$state.counter > 0 && '!text-green-700 bg-green-100'}">
                esto es verde si el contador es positivo
              </p>
            </x-elm>
          </div>
        </section>
      </x-state>
      <x-state value="{showHidden: false, showIf: false}">
        <h2>Conditional rendering</h2>
        <section>
          <h3>Hidden attribute</h3>
          <div>
            <p>
              To avoid inconsistencies with flex designs using gap. The hidden
              attribute will apply a hidden value to the parent element too.
            </p>
            <x-elm>
              <button
                class="btn"
                onclick="{$state.showHidden = !$state.showHidden.value}"
              >
                toggle showHidden
              </button>
            </x-elm>

            <x-elm>
              <p hidden="{$state.showHidden}">Secret value</p>
            </x-elm>
          </div>
        </section>
        <section>
          <h3>x-if</h3>
          <div>
            <x-elm>
              <button
                class="btn"
                onclick="{$state.showIf = !$state.showIf.value}"
              >
                toggle showIf
              </button>
            </x-elm>
            <x-if value="{$state.showIf}">
              <p>ShowIf is true</p>
            </x-if>
            <x-if value="{!$state.showIf.value}">
              <p>ShowIf is false</p>
            </x-if>
          </div>
        </section>
        <section>
          <h3>Bad attributes</h3>
          <div>
            <x-if value="{$state.showIff}">
              <p>this should not be rendered because var name is wrong</p>
            </x-if>
            <x-if value="$state.showIf">
              <p>this should not be rendered because static value</p>
            </x-if>
            <x-if>
              <p>this should not be rendered because no condition</p>
            </x-if>
          </div>
        </section>
      </x-state>
    </main>

    <script>
      function toggleName(name) {
        name.value = name.value === 'John' ? 'Jane' : 'John';
      }

      function incrementCounter(counter) {
        counter.value = counter.value + 1;
      }

      function decrementCounter(counter) {
        counter.value = counter.value - 1;
      }
    </script>
  </body>
</html>
